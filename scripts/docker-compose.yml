version: '3.5'

services:
  homespeaker.client.web:
    image: ${DOCKER_REGISTRY-}snowjallen/homespeakerwebclient:${BuildID}
#    build:
#      context: .
#      dockerfile: HomeSpeaker.Client.Web/Dockerfile
    ports:
     - 80:80
    networks:
     homenet:
    restart: unless-stopped
    environment:
    - ASPNETCORE_ENVIRONMENT=Development
    - HomeSpeaker.Server=http://homespeaker.server

  homespeaker.server:
    image: ${DOCKER_REGISTRY-}snowjallen/homespeakerserver:${BuildID}
#    build:
#      context: .
#      dockerfile: HomeSpeaker.Server/Dockerfile
    ports:
     - 8080:80
    networks:
     homenet:
    restart: unless-stopped
    devices:
    - /dev/snd:/dev/snd
    volumes:
    - "/home/pi/Music:/music"
    environment:
    - MediaFolder=/music
    - ASPNETCORE_ENVIRONMENT=Development
    - ALSA_CARD=Headphones

  # reverseProxy:
  #   image: linuxserver/swag:latest
  #   environment:
  #    - TZ=America/Denver
  #    - URL=beta.sanpetepantry.org
  #    #- SUBDOMAINS=beta
  #    - VALIDATION=http
  #    #- STAGING=true
  #   volumes:
  #    - ./default.conf:/config/nginx/site-confs/default
  #    - cachedcerts:/config
  #   ports:
  #    - 443:443
  #    - 80:80
  #   restart: unless-stopped
  #   networks:
  #    homenet:

networks:
  homenet:

volumes:
  cachedcerts: