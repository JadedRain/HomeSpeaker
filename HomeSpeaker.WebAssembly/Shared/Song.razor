@inject HomeSpeakerService svc
@inject ILogger<Song> logger

@if (SongViewModel == null)
{
    <div>Nothing to see here...</div>
}
else
{
    var classVal = "row ms-1 py-1 gx-0";
    if(ShowBackground)
    {
        classVal += " bg-light";
    }
    <div class=@classVal>
        <div class="col ms-3">
            <div class="text-wrap" @onclick=toggleDetailsView>@SongViewModel.Name</div>
            @if (ShowFolder)
            {
                <div>@SongViewModel.Folder</div>
            }
            @if(showDetails)
            {
                <div class="row">
                    <span class="fw-bold">Song Actions:</span>
                    <button class="btn btn-link" @onclick=delete><span class="oi oi-delete"></span> Delete</button>
                </div>
            }
        </div>
        <div class="col-auto">
            <button @onclick=Play class="btn btn-outline-secondary"><span class="oi oi-media-play" /></button>
            <button @onclick=Queue class="btn btn-outline-secondary"><span class="oi oi-plus" /></button>
        </div>
    </div>
}

@code {
    [Parameter]
    public SongViewModel SongViewModel { get; set; }

    [Parameter]
    public bool ShowFolder{ get; set; }

    [Parameter]
    public bool ShowBackground { get; set; }

    private bool showDetails{ get; set; }

    private void toggleDetailsView() => showDetails = !showDetails;

    async Task Play() => await svc.PlaySongAsync(SongViewModel.SongId);
    async Task Queue() => await svc.EnqueueSongAsync(SongViewModel.SongId);
    async Task delete() => await svc.HomeSpeakerClient.DeleteSongAsync(new DeleteSongRequest { SongId = SongViewModel.SongId });
}
